
-- Shaders
-- vertexShader magically knows attributes (Vertex) must have one field for each
-- attribute in the GLSL shader code
-- variables


vertexShader : Shader Vertex { u | perspective : Mat4 } { vcoord : Vec2, fPosition : Vec3 }
vertexShader =
    [glsl|

attribute vec3 position;
attribute vec3 coord;
uniform mat4 perspective;
varying vec2 vcoord;
varying vec3 fPosition;

void main () {
  gl_Position = perspective * vec4(position, 1.0);
  vcoord = coord.xy;
  fPosition = gl_Position.xyz;
}

|]


fragmentShader : Shader {} { u | crate : Texture } { vcoord : Vec2, fPosition : Vec3 }
fragmentShader =
    [glsl|

precision mediump float;
uniform sampler2D crate;
varying vec2 vcoord;
varying vec3 fPosition;

void main () {
  vec4 tex_Color = texture2D(crate, vcoord);
  vec4 fog_Color = vec4(0.9, 0.9, 1.0, 1.);
  float dist = min(length(fPosition) * 0.1, 1.0);
  gl_FragColor = mix(tex_Color, fog_Color, dist);
}

|]
